const asciiToWidth = [778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 778, 250, 333, 408, 500, 500, 833, 778, 180, 333, 333, 500, 564, 250, 333, 250, 278, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 278, 278, 564, 564, 564, 444, 921, 722, 667, 667, 722, 611, 556, 722, 722, 333, 389, 722, 611, 889, 722, 722, 556, 722, 667, 556, 611, 722, 722, 944, 722, 722, 611, 333, 278, 333, 469, 500, 333, 444, 500, 444, 500, 444, 333, 500, 500, 278, 278, 500, 278, 778, 500, 500, 500, 500, 333, 389, 278, 500, 500, 722, 500, 500, 444, 480, 200, 480, 541, 778, 752, 578, 333, 410, 444, 1000, 500, 500, 500, 1000, 872, 333, 872, 667, 741, 722, 483, 333, 333, 444, 444, 350, 500, 1000, 778, 980, 727, 333, 723, 486, 500, 535, 250, 708, 500, 389, 500, 450, 200, 500, 611, 760, 660, 500, 564, 333, 760, 333, 400, 549, 333, 278, 351, 576, 453, 250, 444, 954, 429, 500, 278, 556, 389, 278, 722, 574, 667, 578, 682, 611, 896, 501, 722, 722, 667, 678, 889, 722, 722, 722, 556, 667, 611, 708, 790, 722, 722, 650, 1009, 1009, 706, 872, 574, 660, 1028, 667, 444, 509, 472, 410, 509, 444, 691, 395, 535, 535, 486, 499, 633, 535, 500, 535, 500, 444, 437, 500, 648, 500, 535, 503, 770, 770, 517, 672, 456, 429, 747, 460, 0, 250, 722, 722, 667, 611, 722, 722, 722, 444, 444, 444, 444, 444, 444, 444, 444, 444, 444, 444, 278, 278, 278, 278, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 333, 333, 549, 889, 722, 713, 549, 549, 500, 494, 713, 823, 549, 274, 276, 310, 768, 667, 500, 444, 333, 549, 500, 549, 612, 722, 722, 722, 889, 722, 549, 494, 500, 722, 167, 556, 556, 722, 611, 722, 611, 611, 333, 333, 333, 333, 722, 722, 722, 722, 722, 722, 278, 333, 333, 333, 333, 333, 333, 333, 333, 333, 333, 611, 278, 556, 389, 611, 444, 722, 500, 722, 500, 556, 500, 564, 564, 300, 300, 300, 750, 750, 750, 500, 722, 500, 333, 556, 389, 667, 444, 667, 444, 500, 500, 333, 722, 444, 722, 444, 722, 646, 722, 611, 444, 611, 444, 611, 278, 611, 406, 611, 344, 722, 500, 722, 500, 722, 500, 667, 333, 667, 333, 556, 389, 611, 278, 611, 427, 722, 500, 722, 500, 611, 444, 611, 444, 578, 722, 731, 524, 471, 420, 539, 402, 577, 500, 573, 315, 969, 1000, 500, 1000, 500, 1000, 500, 500, 979, 722, 564, 600, 564, 604, 604, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 708, 729, 604, 1000, 990, 990, 990, 990, 604, 604, 604, 1021, 1052, 917, 750, 750, 531, 656, 594, 510, 500, 750, 708, 552, 604, 219, 417, 833, 479, 604, 354, 354, 604, 354, 722, 444, 667, 444, 667, 444, 611, 444, 611, 444, 611, 444, 722, 500, 722, 500, 722, 500, 722, 500, 722, 500, 333, 278, 333, 278, 333, 278, 333, 278, 389, 278, 722, 500, 500, 611, 278, 722, 500, 702, 495, 722, 500, 722, 500, 667, 333, 556, 389, 611, 278, 722, 500, 722, 500, 722, 500, 722, 500, 944, 722, 722, 500, 278, 722, 444, 889, 667, 722, 500, 278, 944, 722, 944, 722, 944, 722, 722, 500, 333, 333, 500, 600, 750, 750, 750, 750, 333, 333, 333, 333, 722, 694, 808, 411, 722, 816, 743, 269, 722, 667, 643, 611, 611, 722, 333, 722, 725, 889, 722, 643, 722, 722, 556, 582, 611, 722, 722, 738, 743, 333, 722, 524, 420, 523, 269, 495, 509, 442, 414, 523, 479, 269, 504, 485, 536, 452, 446, 500, 499, 396, 495, 444, 626, 658, 269, 495, 500, 495, 658, 1000, 505, 333, 333, 333, 333, 333, 333, 333, 333, 333, 333, 333, 333, 333, 356, 333, 291, 343, 343, 278, 481, 455, 335, 419, 471, 279, 286, 477, 476, 267, 452, 433, 432, 507, 485, 274, 305, 475, 454, 454, 440, 482, 460, 474, 469, 610, 500, 557, 545, 533, 209, 372, 776, 279, 452, 452, 432, 432, 454, 610, 610, 610, 610, 481, 481, 481, 455, 335, 419, 471, 279, 309, 476, 267, 452, 433, 432, 485, 305, 475, 454, 440, 460, 474, 469, 610, 500, 279, 455, 433, 440, 502, 0, 0, 0, 0, 319, 319, 356, 413, 207, 201, 237, 201, 201, 209, 201, 211, 165, 526, 526, 526, 526, 526, 526, 526, 526, 526, 526, 526, 319, 526, 750, 750, 282, 750, 526, 526, 526, 750, 750, 750, 750, 750, 211, 750, 750, 750, 750, 750, 750, 750, 750, 638, 750, 750, 750, 713, 713, 244, 244, 750, 750, 750, 750, 563, 526, 530, 530, 489, 489, 812, 933, 394, 515, 812, 933, 394, 515, 638, 588, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 226, 211, 211, 211, 211, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 1000, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 319, 319, 750, 616, 413, 207, 229, 207, 229, 432, 432, 207, 229, 638, 588, 244, 244, 207, 229, 713, 713, 244, 244, 282, 375, 713, 713, 244, 244, 713, 713, 244, 244, 563, 526, 530, 530, 563, 526, 530, 530, 563, 526, 530, 530, 337, 337, 337, 337, 489, 489, 489, 489, 821, 821, 531, 531, 821, 821, 531, 531, 1098, 1098, 846, 846, 1098, 1098, 846, 846, 582, 582, 582, 582, 582, 582, 582, 582, 544, 450, 526, 394, 544, 450, 526, 394, 789, 789, 268, 263, 582, 582, 268, 263, 601, 601, 394, 394, 506, 506, 207, 207, 338, 338, 394, 394, 526, 526, 244, 244, 282, 375, 450, 394, 432, 432, 638, 588, 638, 588, 244, 244, 544, 601, 544, 601, 544, 601, 544, 601, 750, 750, 201, 201, 750, 750, 750, 165, 211, 750, 750, 209, 237, 750, 750, 750, 211, 211, 211, 211, 211, 226, 750, 201, 201, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 319, 319, 319, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 125, 1000, 2000, 722, 529, 776, 542, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 513, 750, 750, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 278, 722, 444, 722, 444, 722, 444, 722, 444, 722, 444, 722, 444, 722, 444, 722, 444, 722, 444, 722, 444, 722, 444, 722, 444, 611, 444, 611, 444, 611, 444, 611, 444, 611, 444, 611, 444, 611, 444, 611, 444, 333, 278, 333, 278, 722, 500, 722, 500, 722, 500, 722, 500, 722, 500, 722, 500, 722, 500, 722, 529, 722, 529, 722, 529, 722, 529, 722, 529, 722, 500, 722, 500, 776, 542, 776, 542, 776, 542, 776, 542, 776, 542, 722, 500, 722, 500, 722, 500, 722, 444, 333, 278, 722, 500, 722, 500, 722, 500, 722, 500, 722, 500, 722, 500, 0, 0, 0, 0, 578, 410, 896, 691, 667, 486, 667, 486, 722, 535, 722, 500, 722, 500, 722, 500, 650, 503, 650, 500, 722, 444, 722, 500, 713, 244, 268, 263, 582, 244, 244, 244, 244, 244, 244, 269, 207, 207, 333, 333, 207, 207, 207, 0, 207, 229, 207, 229, 207, 229, 207, 229, 432, 432, 432, 432, 638, 588, 713, 713, 244, 244, 713, 713, 244, 244, 713, 713, 244, 244, 713, 713, 244, 244, 713, 713, 244, 244, 713, 713, 244, 244, 713, 713, 244, 244, 563, 526, 530, 530, 563, 526, 530, 530, 563, 526, 530, 530, 563, 526, 530, 530, 563, 526, 530, 530, 563, 526, 530, 530, 337, 337, 337, 337, 337, 337, 337, 337, 337, 337, 337, 337, 337, 337, 337, 337, 337, 337, 489, 489, 489, 489, 489, 489, 489, 489, 489, 489, 489, 489, 489, 489, 489, 489, 821, 821, 531, 531, 821, 821, 531, 531, 821, 821, 531, 531, 1098, 1098, 846, 846, 1098, 1098, 846, 846, 582, 582, 544, 450, 526, 394, 789, 789, 789, 268, 263, 789, 789, 268, 263, 789, 789, 268, 263, 789, 789, 268, 263, 789, 789, 268, 263, 582, 582, 582, 582, 812, 933, 394, 515, 812, 933, 394, 515, 601, 601, 394, 394, 601, 601, 394, 394, 601, 601, 394, 394, 812, 933, 394, 515, 812, 933, 394, 515, 812, 933, 394, 515, 812, 933, 394, 515, 812, 933, 394, 515, 506, 506, 207, 207, 506, 506, 207, 207, 506, 506, 207, 207, 506, 506, 207, 207, 526, 526, 244, 244, 526, 526, 526, 526, 526, 526, 244, 244, 526, 526, 563, 526, 530, 530, 282, 375, 388, 388, 388, 432, 432, 432, 432, 432, 432, 432, 432, 432, 432, 432, 432, 432, 432, 432, 432, 638, 588, 638, 588, 244, 244, 432, 432, 638, 588, 244, 244, 638, 588, 812, 812, 812, 812, 207, 0, 0, 0, 0, 0, 0, 0, 1123, 1084, 0, 0, 0, 0, 0, 0, 194, 370, 0, 0, 600, 0, 0, 0, 821, 821, 531, 531, 1098, 1098, 846, 846, 544, 450, 526, 394, 413, 338, 282, 244, 320, 244, 244, 244, 244, 244, 812, 933, 267, 0, 342, 533, 544, 601, 544, 601, 544, 601, 544, 601, 544, 601, 544, 601, 544, 601, 526, 526, 544, 601, 534, 1000, 196, 196, 0, 319, 319, 0, 0, 0, 963];

// function clearLeft() {
//   var ad = DocumentApp.getActiveDocument();
//   var docBody = ad.getBody();
//   var paragraphs = docBody.getParagraphs();
//   table = docBody.getTables()[0];
//   leftcell = table.getCell(0, 0);
//   leftcell.clear();
// }

function insertCounts() {
  
  var ad = DocumentApp.getActiveDocument();
  var docBody = ad.getBody();
  var paragraphs = docBody.getParagraphs();
  table = docBody.getTables()[0];
  rightcell = table.getCell(0, 1);
  var width = 6.5;
  var ans = ""; //for debugging
  var realans = "";
  var curwords = 0;
  var numlines = 0;
  var real = false;
  var firstparagraph;
  var listitem;
  if (rightcell.getChild(0).getType() == DocumentApp.ElementType.LIST_ITEM)
  {
    firstparagraph = rightcell.getChild(0).asListItem().getText();
    listitem = true;
  }
  else
  {
    firstparagraph = rightcell.getChild(0).asParagraph().getText();
    listitem = false;
  }
  var linespacing;
  for (var i=0; i<paragraphs.length; i++)
  {
    if (!real)
    {
      if (paragraphs[i].getText() == firstparagraph)
      {
        linespacing = paragraphs[i].getLineSpacing();
        real = true;
      }
    }
    if (!real)
    {
      continue;
    }
    var words = paragraphs[i].getText().split(" ");
    while (words[words.length-1] == "")
    {
      words.pop();
    }
    var curLength = 0;
    width = 6.5 - (paragraphs[i].getIndentFirstLine())/72;
    if (listitem)
    {
      width = 6.0;
    }
    if (listitem)
    {
      curwords = 0;
    }
    for (var j = 0; j<words.length; j++)
    {
      var letterLength = 0;
      if (words[j] === "")
      {
        continue;
      }
      for (var k=0; k<words[j].length; k++)
      {
        var asciiValue = words[j][k].charCodeAt(0);
        if (asciiValue > 8210)
        {
          asciiValue = asciiValue - 8210 + 1708;
        }
        letterLength += asciiToWidth[asciiValue];
      }
      if (curLength + letterLength > 6000*width) 
      {
        ans = ans + String(curwords) + " last word: " + words[j-1] + "\n";
        realans = realans + String(curwords) + "\n";
        numlines++;
        //console.log(words[j-1], curLength, letterLength);
        curLength = letterLength + asciiToWidth[" ".charCodeAt(0)];
        
        if (!listitem && width < 6.4999999)
        {
          width = 6.5;
        }
        
      }
      else
      {
        curLength += letterLength+asciiToWidth[" ".charCodeAt(0)];
      }
      if (words[j] != "â€”")
      {
        curwords++;
      }
    }
    if (words.length !== 0)
    {
      ans = ans + String(curwords) + " last word: " + words[words.length-1] + "\n";
      realans = realans + String(curwords) + "\n";
      numlines++;
    }
  }
  console.log(ans);
  leftcell = table.getCell(0, 0);
  leftcell.setText(realans);
  for (var i=0; i<numlines+1; i++)
  {
    var cellStyle = {};
    cellStyle[DocumentApp.Attribute.HORIZONTAL_ALIGNMENT] = DocumentApp.HorizontalAlignment.CENTER;
    cellStyle[DocumentApp.Attribute.LINE_SPACING] = linespacing;
    leftcell.getChild(i).asParagraph().setAttributes(cellStyle)
  }
}
